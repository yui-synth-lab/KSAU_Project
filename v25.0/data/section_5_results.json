{
  "date": "2026-02-18",
  "w_new_1_fix_note": "W-NEW-1 fix (Session 7, P-S7-1): date corrected from 2026-02-19 to 2026-02-18 per SSoT unification declared in Session 4.",
  "m_s7_1_ssot_fix_note": "M-S7-1 fix (Session 7): n_s corrected 0.965→0.9667 and Omega_r0 corrected 9.1e-5→9.2e-5 in section_5_cmb_design.py to match SSoT v23.0/data/cosmological_constants.json.",
  "ssot_parameter_comparison": {
    "note": "M-S7-1: SSoT vs code values after fix",
    "H0":       {"code": 67.4,   "ssot": 67.4,   "match": true},
    "Omega_m0": {"code": 0.315,  "ssot": 0.315,  "match": true},
    "Omega_L0": {"code": 0.685,  "ssot": 0.685,  "match": true},
    "sigma8":   {"code": 0.811,  "ssot": 0.811,  "match": true},
    "n_s":      {"code_before_fix": 0.965, "code_after_fix": 0.9667, "ssot": 0.9667, "match": true},
    "Omega_r0": {"code_before_fix": 9.1e-5, "code_after_fix": 9.2e-5, "ssot": 9.2e-5, "match": true}
  },
  "section": "Section 5",
  "type": "design_document_only",
  "section_5a_interface": {
    "current_function": {
      "signature": "predict_s8_z(z, r0, beta, use_nl=False)",
      "growth_model": "d_z = a^gamma_k (power-law approximation)",
      "valid_range": "z < 1 (WL surveys)",
      "failure_mode": "Overestimates growth at z > 1"
    },
    "proposed_extension": {
      "new_function_name": "predict_s8_z_extended",
      "signature": "predict_s8_z_extended(z, r0, beta, use_nl=False, use_lcdm_growth=False)",
      "parameters": {
        "use_lcdm_growth": "bool: If True, use numerical ΛCDM growth factor D(z) from Planck 2018 integration (valid at z > 1). If False, use current power-law approximation (legacy).",
        "growth_normalisation": "float: normalise D(z) such that D(0)=1. Default: True."
      },
      "growth_function_new": {
        "method": "Numerical ODE or integral: D(z) ∝ H(z) × ∫_{z}^{∞} dz'/(H(z')^3 × a'^3)",
        "reference": "Heath (1977), Eq. 13; Carroll et al. (1992)",
        "implementation": "scipy.integrate.quad with Planck 2018 H(z)"
      },
      "backward_compatibility": "When use_lcdm_growth=False (default), behaviour identical to v23.0. All existing v23.0/v24.0 results are unchanged.",
      "test_protocol": "Validate: for z ∈ [0, 1], D_ΛCDM(z) vs D_powerlaw(z) < 5% difference. For z ∈ [1, 3], D_ΛCDM(z) is used instead of power-law."
    },
    "integration_plan": {
      "phase_v26": "Implement use_lcdm_growth=True in loo_cv_engine_v26.py",
      "phase_v26_test": "Verify ACT-DR6/Planck PR4 forward prediction at z_eff~1.0",
      "phase_v27": "Full CMB lensing LOO-CV integration"
    }
  },
  "section_5b_growth_fn": {
    "omega_m0": 0.315,
    "omega_L0": 0.685,
    "z_array": [
      0.0,
      0.2551,
      0.5102,
      0.7653,
      1.0204,
      1.2755,
      1.5306,
      1.7857,
      2.0408,
      2.2959
    ],
    "D_LCDM": [
      1.0,
      0.87315,
      0.764701,
      0.674794,
      0.60091,
      0.540027,
      0.489448,
      0.447001,
      0.411,
      0.380152
    ],
    "D_powerlaw": [
      1.0,
      0.882524,
      0.797132,
      0.731558,
      0.679217,
      0.636219,
      0.600103,
      0.569226,
      0.542445,
      0.518935
    ],
    "comparison_key_z": [
      {
        "z": 0.0,
        "D_LCDM": 1.0,
        "D_powerlaw": 1.0,
        "dev_pct": 0.0
      },
      {
        "z": 0.26,
        "D_LCDM": 0.870886,
        "D_powerlaw": 0.880636,
        "dev_pct": 1.119
      },
      {
        "z": 0.33,
        "D_LCDM": 0.83931,
        "D_powerlaw": 0.854834,
        "dev_pct": 1.85
      },
      {
        "z": 0.4,
        "D_LCDM": 0.809188,
        "D_powerlaw": 0.831055,
        "dev_pct": 2.702
      },
      {
        "z": 0.52,
        "D_LCDM": 0.760918,
        "D_powerlaw": 0.794303,
        "dev_pct": 4.387
      },
      {
        "z": 0.6,
        "D_LCDM": 0.731041,
        "D_powerlaw": 0.772207,
        "dev_pct": 5.631
      },
      {
        "z": 1.0,
        "D_LCDM": 0.606303,
        "D_powerlaw": 0.68302,
        "dev_pct": 12.653
      },
      {
        "z": 1.5,
        "D_LCDM": 0.49505,
        "D_powerlaw": 0.604134,
        "dev_pct": 22.035
      },
      {
        "z": 2.0,
        "D_LCDM": 0.416384,
        "D_powerlaw": 0.546491,
        "dev_pct": 31.247
      },
      {
        "z": 2.5,
        "D_LCDM": 0.358511,
        "D_powerlaw": 0.502068,
        "dev_pct": 40.043
      }
    ],
    "s8_correction_factor_at_z1": 0.88768,
    "diagnostic": "At z=1.0: D_ΛCDM=0.6063 vs D_powerlaw=0.6830 (ratio=0.8877). Power-law deviation at z=1: 12.7%. This systematic bias is the primary cause of the 4.35σ CMB lensing failure."
  },
  "section_5c_cmb_data": {
    "_description": "CMB lensing datasets for v26+ forward prediction testing",
    "_note": "NOT included in v25.0 LOO-CV. These are z > 1 (lens plane at z > 0.5) and require the ΛCDM growth function (Section 5b). Forward prediction with v23.0 engine failed 4.35σ (v24.0 Session 4).",
    "datasets": {
      "ACT-DR6": {
        "S8_obs": 0.84,
        "S8_err": 0.028,
        "z_eff": 1.0,
        "ref": "Qu et al. (2023), arXiv:2304.05196",
        "notes": "ACT DR6 CMB lensing + SDSS galaxies. z_eff~1.0.",
        "type": "CMB_lensing"
      },
      "Planck_PR4": {
        "S8_obs": 0.823,
        "S8_err": 0.023,
        "z_eff": 0.95,
        "ref": "Carron et al. (2022), JCAP 09 (2022) 039",
        "notes": "Planck PR4 CMB lensing. z_eff~0.95-1.05.",
        "type": "CMB_lensing"
      }
    },
    "v24_session4_failure": {
      "predicted_S8_ACT": 0.704,
      "predicted_S8_Planck": 0.712,
      "tension_ACT_sigma": 4.86,
      "tension_Planck_sigma": 4.83,
      "note": "v24.0 Session 4 forward prediction failed catastrophically at >4σ."
    },
    "v26_implementation_requirements": [
      "Implement predict_s8_z_extended with use_lcdm_growth=True",
      "Validate D(z) growth function against CAMB/CLASS output",
      "Test forward prediction for ACT-DR6 and Planck PR4",
      "If tension < 2σ, consider adding to LOO-CV pool in v27.0"
    ]
  },
  "roadmap_compliance": {
    "design_doc_created": true,
    "growth_fn_prototype": true,
    "cmb_data_added": true,
    "implementation_required": false,
    "target_version": "v26.0+"
  }
}