# KSAU v5.0: Analysis Scripts

This directory contains all verification and visualization scripts for the KSAU v5.0 paper.

## Quick Start

```bash
# Install dependencies
pip install numpy scipy matplotlib

# Optional (for high-precision verification)
pip install mpmath

# Run main prediction script
python ksau_v5_prediction.py

# Generate all figures
python plot_mass_hierarchy.py

# Run statistical tests
python permutation_test.py

# Verify Catalan identity
python catalan_pi24_verify.py
```

---

## Scripts Overview

### 1. `ksau_v5_prediction.py`

**Purpose**: Core mass prediction and validation

**Features**:
- Computes predicted masses for all 9 fermions
- Validates three selection rules
- Reports summary statistics (MAE, R², etc.)
- Verifies Catalan-π/24 identity

**Output**:
```
Global MAE: 3.33%
Quark MAE:  4.84%
Lepton MAE: 0.32%
```

**Runtime**: < 1 second

---

### 2. `plot_mass_hierarchy.py`

**Purpose**: Generate publication-quality figures

**Generates**:
- `figure1_mass_spectrum.png` - Mass hierarchy with predictions
- `figure2_error_comparison.png` - v4.1 vs v5.0 performance
- `figure3_twist_effect.png` - Impact of Twist correction
- `figure4_correlation.png` - Volume/N² vs log(mass)
- `figure5_catalan_identity.png` - G ≈ 7π/24 visualization
- `figure6_determinant_rules.png` - Binary Det pattern

**Dependencies**:
- matplotlib (required)

**Usage**:
```bash
python plot_mass_hierarchy.py
```

**Output**: 6 PNG files (300 DPI, publication-ready)

**Runtime**: ~5 seconds

---

### 3. `permutation_test.py`

**Purpose**: Statistical significance testing

**Tests Performed**:
1. **Permutation Test** (100,000 trials)
   - Tests if topology-mass correlation is random
   - p-value: ~8×10⁻⁵ (4.1σ significance)

2. **Bootstrap Confidence Intervals** (10,000 trials)
   - 95% CI: [2.4%, 5.1%]
   - 99% CI: [1.9%, 6.2%]

3. **Leave-One-Out Cross-Validation**
   - LOO-CV MAE: 3.34%
   - Confirms no overfitting

**Output**:
- Console report with detailed statistics
- `permutation_test_results.png` - Histogram with p-value

**Runtime**: ~30 seconds

---

### 4. `catalan_pi24_verify.py`

**Purpose**: High-precision verification of G ≈ 7π/24

**Features**:
- Standard precision (NumPy, 16 digits)
- High precision (mpmath, 50 digits, optional)
- Tests alternative approximations (ln(5/2), etc.)
- Verifies v4.1 ↔ v5.0 coefficient equivalence
- Explains theoretical significance of π/24

**Output**:
```
G (Catalan)     = 0.915965594177219
7π/24           = 0.916297857297023
Difference      = 0.000332263119804
Relative error  = 0.0363%
```

**Runtime**: < 1 second (without mpmath), ~2 seconds (with mpmath)

---

## Dependencies

### Required
```
numpy >= 1.20.0
```

### Recommended
```
matplotlib >= 3.4.0   # For figure generation
scipy >= 1.7.0        # For statistical tests
```

### Optional
```
mpmath >= 1.2.0       # For high-precision Catalan verification
snappy                # For computing hyperbolic volumes (not needed for verification)
```

Install all at once:
```bash
pip install numpy scipy matplotlib mpmath
```

---

## File Structure

```
v5.0/
├── code/
│   ├── README.md                      # This file
│   ├── ksau_v5_prediction.py          # Main prediction script
│   ├── plot_mass_hierarchy.py         # Generate figures 1-6
│   ├── plot_exhaustive_search.py      # Generate supplementary figures
│   ├── permutation_test.py            # Statistical tests
│   └── catalan_pi24_verify.py         # Catalan identity verification
│
└── figures/                           # (generated by scripts)
    ├── figure1_mass_spectrum.png
    ├── figure2_error_comparison.png
    ├── figure3_twist_effect.png
    ├── figure4_correlation.png
    ├── figure5_catalan_identity.png
    ├── figure6_determinant_rules.png
    ├── figureS1_exhaustive_search.png
    ├── figureS2_complexity_tradeoff.png
    └── permutation_test_results.png
```

---

## Reproducing Paper Results

To reproduce all numerical results and figures from the paper:

```bash
# 1. Run main prediction
python ksau_v5_prediction.py > results.txt

# 2. Generate figures
python plot_mass_hierarchy.py

# 3. Run statistical tests
python permutation_test.py > stats.txt

# 4. Verify Catalan identity
python catalan_pi24_verify.py > catalan.txt
```

Expected outputs:
- Global MAE: 3.33%
- p-value: ~8×10⁻⁵
- Catalan error: 0.036%
- 7 publication-quality figures

**Total runtime**: ~40 seconds

---

## Key Constants

All scripts use the following constants:

```python
KAPPA = np.pi / 24      # ≈ 0.130899694 (master constant)
G = 0.915965594177219   # Catalan constant
```

**Relationship**: `G ≈ 7π/24 = 7 × KAPPA` (error: 0.036%)

---

## Troubleshooting

### "ModuleNotFoundError: No module named 'mpmath'"
- mpmath is optional. The script will fall back to NumPy.
- To use high-precision features: `pip install mpmath`

### Figures look pixelated
- Ensure matplotlib DPI setting: `rcParams['figure.dpi'] = 300`
- Save with `bbox_inches='tight'` to avoid clipping

### "UnicodeEncodeError" on Windows
- All scripts use ASCII-compatible output
- If you see this, ensure terminal encoding is UTF-8

---

## Citation

If you use these scripts, please cite:

```bibtex
@article{KSAU_v5_2026,
  title={Topological Mass Generation from π/24:
         Unifying Chern-Simons Theory with Catalan Geometry},
  author={Yui},
  journal={arXiv preprint arXiv:XXXX.XXXXX},
  year={2026}
}
```

---

## License

CC BY 4.0 - Free to use with attribution.

Data sources:
- **Particle masses**: Particle Data Group (PDG 2024)
- **Hyperbolic volumes**: SnapPy / KnotInfo database
- **Topological invariants**: KnotInfo (Indiana University)

---

**Last Updated**: February 7, 2026
