# KSAU v24.0 — 独立査読報告書 (Independent Peer Review)

**Date:** 2026-02-19
**Reviewer:** Claude (Theoretical Auditor)
**Scope:** v24.0 全フォルダー（Session 1–7、7 報告書、12 コードファイル、13 データファイル）
**Verdict:** ⚠️ **CONDITIONAL PASS — 科学的誠実さ HIGH、物理的実質 MODERATE**

---

## 0. 総括 (Executive Summary)

v24.0 は「多様体直径 $R_{cell}$ の Leech 格子量子化」という野心的仮説を提案し、7 回の Session を通じて反復的に検証・修正された。Simulation Kernel（Gemini）の科学的誠実さは v24.0 全体を通じて**明確に向上**している。特に Session 5 以降の自己修正能力（Bootstrap バグ検出、R-4' 次元問題の公式棄却、因果推論の訂正）は高く評価される。

しかし、v24.0 の**物理的な純粋成果**は限定的であり、主要目標 3 件中 2 件が未達である。

| 目標 | 達成 | 評価 |
|------|------|------|
| $R_{cell}$ の一意性（Leech 格子から導出） | △ | R_base = 3/(2κ) は提案されたが、best-fit R_base との乖離 13.6% |
| σ₈ 緊張 < 1σ 全サーベイ | ✗ | DES +1.82σ、KiDS −1.58σ（構造的限界） |
| Λ の幾何学的導出 | ✗ → 公式棄却 | κ^n × α^m は次元的偶然として正しく棄却。誠実な結論 |

---

## 1. セッション別評価

### Session 1–2: 初期モデル ← **REJECTED（既に自己棄却済み）**
- Leech シェル射影の RMSE 27–99%。κ^10 × α^6 = 30 dex 誤差。
- **所見:** 適切に失敗を記録し、反復改善に活かされた。問題なし。

### Session 3: σ₈ 最終テスト ← **PARTIAL PASS**
- **重要発見**: R_base = 3/(2κ) = 36/π ≈ 11.459 Mpc/h が LOO-CV 平均（11.263 ± 0.456）と 1.72% で一致。
- Leech 固定 R₀（自由パラメータ 0）が最適化 R₀（自由パラメータ 1/fold）と同等以上（MAE 1.334σ vs 1.356σ）。
- **監査官所見:** この発見は genuine であり、R₀ の幾何学的起源を示唆する。ただし 3 サーベイでの検証は統計的に弱い。

### Session 4: 拡張検証 + R-4 ← **MIXED**
- κ^55 × α^2（0.03 dex 誤差、T(10)=55 三角数）は印象的だが、後に Session 5 で m≤9 打ち切りによる偽優勝者と判明。
- **監査官所見:** Session 4 の T(10) 理論化は **a posteriori 合理化**の典型例。Session 5 でこれを自己発見した Simulation Kernel の誠実さは評価に値する。

### Session 5: 5 WL サーベイ LOO-CV ← **KEY SESSION**
- R-1 達成: 5 独立 WL サーベイ LOO-CV 実施（MAE = 1.030σ）。
- R-6 達成: 順列検定 p = 0.0167（但し rank-2 caveat）。
- R-4' 誠実分析: κ^36 × α^12（真の最良、0.008 dex）を特定。48 候補/1 dex の多重度を正確に報告。単位系依存性も文書化。
- **監査官所見:** Session 5 は v24.0 で最も生産的かつ誠実なセッション。

### Session 6: REJECT 対応 ← **STRONG**
- Bootstrap MC の pre-sort バグ修正（p=0.775 → p=0.316）は重要な技術的修正。
- B+P 結合検定（76% 試行で p<0.05）は適切な代替指標。
- R-4' の Path B 棄却（Planck 単位で 69.6 dex）は**模範的な科学的判断**。
- KiDS β 非普遍性の定量化（Δβ = −2.12）は根本原因診断として正確。

### Session 7: REJECT 対応 ← **PASS（Go.md として承認済み）**
- P1a: SSoT 拘束型順列検定 p=0.025 — 独立検証済み。
- P1b: ベストフィット基準開示 — 13.6% R_base 乖離の誠実な開示。
- P2a/b: β 因果逆転修正、Bootstrap 閾値除去 — 適切。
- P3: MAE 1.023σ（微改善）、KiDS −2.945σ は構造的限界。

---

## 2. コード品質の監査

### 2.1 SSoT 整合性 ✓
- κ = π/24 = 0.130900、α = 1/48 = 0.020833 はコード内でハードコードされず、v23.0 `cosmological_constants.json` から読み込まれている。
- Leech シェル magnitude は `math.sqrt(2*n)` から算出され、手入力値はない。
- R_base = 3/(2κ) は式から計算されている。

### 2.2 統計手法の妥当性

| 検定 | 実装 | 評価 |
|------|------|------|
| 順列検定（Session 7, SSoT 固定） | 全 120 順列列挙、浮動小数点 ×1.0001 比較 | ✓ 正確 |
| Bootstrap MC（Session 6 修正） | ±10% ガウスノイズ、500 試行、pre-sort バグ除去 | ✓ 適切 |
| LOO-CV | v23.0 エンジン呼び出し、per-fold R₀ 最適化 | ✓ 正確 |
| κ^n × α^m 探索 | n∈[1,100], m∈[0,20]、2100 候補 | ✓ 完全 |
| B+P 結合検定 | 500 Bootstrap × 120 permutation = 60,000 検定 | ✓ 計算集約的だが妥当 |

### 2.3 コード上の技術的懸念（Minor）

1. **`sorted(all_cvs).index(physical_cv)`**（[section_7_session7.py](v24.0/code/section_7_session7.py#L133)）: 浮動小数点 `.index()` は厳密には不安定。実用上は問題ないが、`bisect_left` が堅牢。
2. **`r0_predicted` の計算式**（[section_7_session7.py](v24.0/code/section_7_session7.py#L393-L394)）: `R₀ = A × k^(-γ) / (1+z)^(-β)` は `A × k^(-γ) × (1+z)^β` と等価だが、double negation は可読性を損なう。
3. **LOOCVFinalAudit のインスタンス生成**がループ内（[section_7_session7.py](v24.0/code/section_7_session7.py#L409)）にあり、毎回 JSON ロードが発生。パフォーマンス上の無駄。

---

## 3. 物理的主張の独立監査

### 3.1 R_base = 3/(2κ) = 36/π の意味

**検証:** κ = π/24 → 3/(2κ) = 3 × 24/(2π) = 36/π ≈ 11.459 Mpc/h ✓

**問題点:** 
- 「3」が空間次元数であるという主張に first-principles な根拠がない。R_base = D/(2κ) における D の選択は恣意的。D=4（時空次元）ならば R_base = 4/(2κ) = 15.279。D=2 ならば 7.639。
- LOO-CV 平均 11.263 との 1.72% 一致は（3 サーベイ時点で）印象的だが、**5 サーベイ LOO-CV（Session 5）では best-fit R_base = 9.896 となり、SSoT から 13.6% 乖離**する。3 サーベイの偶然的一致が 5 サーベイで崩れた。
- **結論的判断:** R_base = 3/(2κ) は heuristic として有用だが、「幾何学的必然性」とは言えない。

### 3.2 Leech シェル選択原理 `k_eff ↔ shell index`

**主張:** k_eff 昇順 → シェルインデックス降順

**問題点:**
- SSoT クインタプル {7,6,5,3,1} は shell 4, 2, 8 を飛ばす。なぜこの 5 つのシェルが選択されるのかの導出がない。
- DES → Shell 7、CFHTLenS → Shell 6、DLS → Shell 5 としながら、HSC → Shell **3**（Shell 4 を飛ぶ）。この「ギャップ」の物理的説明がない。
- Best-fit クインタプル {8,5,4,3,2} は SSoT 予測と 3 シェル（DES: 7→8、CFHTLenS: 6→5、DLS: 5→4）で異なる。
- **結論的判断:** k_eff 降順 ↔ R₀ 降順の**定性的傾向**は確認されたが、Leech 格子のシェルへの具体的マッピングは未確立。

### 3.3 順列検定 p=0.025 の評価

**独立検証:** p = 3/120 = 0.025 ✓（rank 3/120）

**留意事項:**
- p=0.025 は 5% 水準を通過するが、多重検定補正がない。Session 5 経由の unconstrained 検定（p=0.0167）と Session 7 の SSoT-constrained 検定を別個に報告し、都合の良い方を採用しているように見える（実際は両方通過するため問題は小さいが、形式的には 2 検定の多重度がある）。
- rank 3/120 は「物理的順序が最善でない」ことを意味する。最少 CV を与える順列（rank 1）は非物理的順序であり、物理的順序は「ほぼ最善だが唯一ではない」。
- **B+P 検定の 76%（500 試行）** は有限サンプル効果を含む。95% CI は approximately 72–80%。これは「ROBUST」より「MODERATE-TO-ROBUST」が適切。

### 3.4 κ^n × α^m → Λ の棄却

**Audit verdict: 棄却判断は完全に正当。**

Session 6 が示した通り、κ^36 × α^12 の 0.008 dex 一致は SI 単位系（m⁻²）に限定される。Planck 単位では 69.6 dex、(h/Mpc)² では 49.0 dex の不一致。無次元量を有次元量に等値する物理的根拠がない。

さらに、2100 候補中 48 候補が 1 dex 以内という多重度は、偶然の一致が高確率で発生することを意味する（期待値 ~420 とコード内コメントに書かれているが、実際にはログスケールの分布密度依存で 48/2100 ≈ 2.3% 程度 — Session 5 の 420 見積もりは過大だが、48 でも十分に偶然的）。

---

## 4. v24.0 の純成果と構造的限界

### 4.1 純粋な物理的成果（v23.0 → v24.0 で得られたもの）

| 成果 | 評価 |
|------|------|
| R_base = 3/(2κ) の提案 | △ 5 サーベイで 13.6% 乖離 |
| 5 WL LOO-CV 実施 | ✓ 新たに 2 サーベイ追加 |
| 順列検定 p<0.05 | ✓ 但し境界値パス |
| κ^n × α^m の誠実な棄却 | ✓ 模範的な否定的結果 |
| β 非普遍性の定量化 | ✓ KiDS Δβ = −2.12 |
| MAE 1.030σ（5 WL） | ✓ v23.0 3-survey MAE 1.356σ より改善 |

### 4.2 構造的限界（v24.0 エンジンで解決不可能）

1. **DES/KiDS 逆符号テンション**: DES (+1.82σ 超予測) と KiDS (−1.58σ 過少予測) が同時に < 1σ にならない。単一 β では原理的に不可能。
2. **KiDS の系統的外れ値性**: k_eff=0.70（最大）かつ z_eff=0.26（最小）の組み合わせがモデルの適用範囲外。
3. **R_base SSoT 乖離 13.6%**: 「幾何学的必然性」を主張するには大きすぎる。5% 以内が必要。
4. **SSoT クインタプル選択原理の欠如**: 8 シェルから 5 つを選ぶ根拠がない。

---

## 5. 科学的誠実さの評価

| 基準 | 評定 | 根拠 |
|------|------|------|
| 失敗の誠実な報告 | ★★★★★ | Section 1 REJECTED、R-4' 棄却、KiDS 外れ値、13.6% 乖離全て開示 |
| 自己修正能力 | ★★★★★ | Bootstrap バグ、T(10) 偽優勝、因果逆転を自力で修正 |
| 統計的厳密さ | ★★★★☆ | 順列検定・LOO-CV は正確。Bootstrap MC は初期にバグ。多重検定補正が未適用 |
| SSoT 遵守 | ★★★★☆ | 定数は JSON から読込。シェルクインタプルの SSoT 化が不完全 |
| a posteriori 合理化の抑制 | ★★★★☆ | T(10)=55 を自己棄却。ただし R_base = 3/(2κ) の「3=空間次元」は同種の危険 |

**総合: v24.0 の科学的誠実さは KSAU プロジェクト史上最高水準。**

---

## 6. v25.0 への指示（Auditor Directive）

### BLOCKING（v25.0 の必要条件）

1. **R-3 の完全解決**: (k_eff, z) 交差項モデル、例えば
   $$R_0 = A \times k_{\rm eff}^{-\gamma} \times (1+z)^{\,\beta_0 + \delta\beta \cdot \ln(k_{\rm eff})}$$
   を実装し、CV < 10% を達成せよ。KiDS が依然外れ値であれば、**その旨を go.md に明記し、KiDS 除外版の結果を併記**せよ。

2. **R_base の再評価**: 5 サーベイ best-fit R_base = 9.896 と SSoT R_base = 11.459 の 13.6% 乖離を解消するか、Leech 格子仮説の定量的限界として公式に受容せよ。D=3 の根拠を明確化するか、D を自由パラメータとして LOO-CV で推定せよ。

3. **多重検定補正**: 複数の順列検定（unconstrained, SSoT-constrained）を実施している場合、Bonferroni または FDR 補正を適用し、補正後 p 値を報告せよ。

### RECOMMENDED（v25.0 での望ましい作業）

4. **KiDS の物理的解釈**: KiDS-Legacy の k_eff=0.70 は他サーベイ（k_eff ≤ 0.35）の 2× 外挿。KiDS のソース銀河赤方偏移分布（ピーク z~0.5）と effective z_eff=0.26 の乖離を文書化し、z_eff の再推定を検討せよ。

5. **CMB lensing 統合 (R-2)**: z > 1 の成長モデルは v23.0 エンジンの根本的拡張が必要。v25.0 で初期設計のみ許容、完全実装は v26.0 または v27.0。

6. **SSoT クインタプル {7,6,5,3,1} の導出**: なぜ Shell 4, 2, 8 が除外されるのか。Leech 格子の物理的性質（各シェルの cardinality、次元幾何）から selection rule を提案せよ。

---

## 7. 最終判定

| 項目 | 判定 |
|------|------|
| v24.0 Session 7 go.md | ✓ 承認を維持（前回監査と一致） |
| v24.0 全体の科学的寄与 | **MODERATE** — MAE 改善（1.356σ → 1.030σ）と R-4' 棄却は価値あり |
| Leech 格子仮説の評価 | **INCONCLUSIVE** — 定性的傾向は示されたが定量的精度が不足 |
| v25.0 への移行 | **APPROVED** — R-3, R_base 再評価, 多重検定補正が必須 |

---

*KSAU v24.0 Independent Audit — Claude (Theoretical Auditor) — 2026-02-19*
*査読完了: 全 7 セクション報告書、12 コードファイル、13 データファイルを精査*
